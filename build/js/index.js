/*! date 2015-07-22 */
var SF={now:0,num:10,answer:[3,1,3,0,2,6,1,0,1,1],score:0,aUrl:img_arr};SF.Wx=function(){this.welcome=null,this.main=null,this.index=null,this.score=null,this.settings={now:0,num:SF.num,answer:SF.answer,score:SF.score,btn:!0,aUrl:SF.aUrl}},SF.Wx.prototype={constructor:SF.Wx,init:function(a,b){var c=this;$.extend(!0,{},this.settings,b),c.welcome=a.welcome,c.index=a.index,c.main=a.main,c.score=a.score,c.load(),c.nextissue()},load:function(){for(var a=this,b=a.welcome.find(".percent span"),c=a.welcome.find(".bar p"),d=a.welcome.find(".bar cite"),e=0,f=0;f<a.settings.aUrl.length;f++){var g=new Image;g.onload=function(){e++;var f=parseInt(e/a.settings.aUrl.length*100)+"%";b.html(f),c.css({transform:"translateX("+f+")",webkitTransform:"translateX("+f+")"}),e==a.settings.aUrl.length&&(d.css({background:"#ffcc33"}),window.onload=function(){setTimeout(function(){a.welcome.hide(a.create_index())},500)})},g.onerror=function(){e++;var f=parseInt(e/a.settings.aUrl.length*100)+"%";b.html(f),c.css({transform:"translateX("+f+")",webkitTransform:"translateX("+f+")"}),e==a.settings.aUrl.length&&(d.css({background:"#ffcc33"}),window.onload=function(){setTimeout(function(){a.welcome.hide(a.create_index())},500)})},g.src=a.settings.aUrl[f]}},create_index:function(){var a=this;a.index.find(".theme-content").addClass("themein"),a.index.find(".ship").addClass("shipin"),a.index.find(".shiper-content").addClass("shiperin"),a.index.find(".begin span")[0].addEventListener("touchstart",function(){a.index.hide(a.create_card())},!1)},create_card:function(){var a=this;a.main.find(".blackboard-content").addClass("blackboarddown"),a.main.find(".card-content").addClass("cardshow"),a.main.find(".card-content").on("webkitAnimationEnd AnimationEnd",function(){a.begin_answer()})},setState:function(){var a=this,b=a.main.find(".person"),c=a.main.find(".answer"),d=a.main.find(".blackboard-content p");b.stop(!0).css({display:"none"}),c.stop(!0).css({display:"none"}),9==a.settings.now&&(a.main.find(".next span").hide(),a.main.find(".next em").show()),d.hide(),d.eq(a.settings.now).show(),a.begin_answer()},begin_answer:function(){var a=this,b=a.main.find(".card-list"),c=b.eq(a.settings.now).find(".card-question li"),d=c.length;0!=a.settings.now&&(b.eq(a.settings.now-1).addClass("cardout"),b.eq(a.settings.now-1).on("webkitAnimationEnd",function(){b.eq(a.settings.now-1).hide().removeClass("cardout")}));for(var e=0;d>e;e++)c[e].addEventListener("touchstart",function(){var b=$(this).index();return a.settings.btn?(a.settings.now++,a.settings.btn=!1,b==a.settings.answer[a.settings.now-1]?($(this).find("span").css({display:"block"}),a.right_answer(),!1):6==a.settings.answer[a.settings.now-1]?($(this).find("span").css({display:"block"}),a.right_answer(),!1):($(this).addClass("shake"),$(this).find("cite").css({display:"block"}),a.wrong_answer(),!1)):!1},!1);b.eq(a.settings.now).find(".card-question li").on("webkitAnimationEnd AnimationEnd",function(){return $(this).removeClass("shake"),!1})},nextissue:function(){var a=this,b=a.main.find(".next span");b[0].addEventListener("touchstart",function(){return a.settings.btn?(a.no_answer(),!1):(a.settings.btn=!0,a.setState(),!1)},!1)},no_answer:function(){function a(a){var a=a||window.event;a.preventDefault(),a.cancelBubble=!0}var b=$(document).height(),c=($(window).height(),$(window).scrollTop()),d=$("body");if(0!=$("div[name=alertmask]").length)return!1;!function(){var a="<div class='alertmask' name='alertmask' style='background:#000; opacity:0.75;display:block;overflow:hidden;position:fixed; left:0px; top:0px; width:100%; z-index:999; height:"+(b+c)+"px' ></div>",e="<div name='alertMsgDialog' class='msg' id='msg' style='position:fixed; z-index:1000;'><span></span></div>";d.append(a),d.append(e)}(),d.eq(0).css("overflow","hidden"),document.addEventListener("touchmove",a,!1);var e=$(".alertmask"),f=$("#msg");$("#msg span")[0].addEventListener("touchstart",function(){document.removeEventListener("touchmove",a,!1),e.remove(),f.remove(),d.eq(0).css("overflow","auto")},!1)},see_score:function(){var a=this,b=a.main.find(".next em");b[0].addEventListener("touchstart",function(){return a.settings.btn?(a.no_answer(),!1):(a.main.hide(a.show_score()),!1)},!1)},right_answer:function(){var a=this,b=a.main.find(".person-r"),c=a.main.find(".answer-r");a.settings.score+=10,b.eq(a.settings.now-1).show().addClass("personin"),b.eq(a.settings.now-1).on("webkitAnimationEnd",function(){c.eq(a.settings.now-1).show(function(){10==a.settings.now&&a.see_score()})})},wrong_answer:function(){var a=this,b=a.main.find(".person-w"),c=a.main.find(".answer-w");b.eq(a.settings.now-1).show().addClass("personin"),b.eq(a.settings.now-1).on("webkitAnimationEnd",function(){c.eq(a.settings.now-1).show(function(){10==a.settings.now&&a.see_score()})})},show_score:function(){var a=this,b=a.score.find(".score-btn span"),c=a.score.find(".score-btn em");a.score.find(".score-card-content h4 span").html(a.settings.score+"<em></em>");var d=a.score.find(".score-card-content p"),e=a.score.find(".score-card-content>span"),f=["搜航的保洁小妹打了100分，你看着办。","去“船长课堂”蹭课去，不收费。","哎呦喂，加把劲就能上100了，看好你哦。","天才，你打100分的原因是总分才100。"],g=parseInt(a.settings.score);30>=g?(d.html(f[0]),e.eq(0).addClass("papa")):g>30&&60>=g?(e.eq(1).addClass("papa"),d.html(f[1])):g>60&&90>=g?(e.eq(2).addClass("papa"),d.html(f[2])):(e.eq(3).addClass("papa"),d.html(f[3])),b[0].addEventListener("touchstart",function(){a.reset()},!1),c[0].addEventListener("touchstart",function(){a.share()},!1)},reset:function(){var a=this,b=a.main.find(".person"),c=a.main.find(".answer"),d=a.main.find(".card-list"),e=a.main.find(".blackboard-content p");a.settings.now=0,a.settings.score=0,a.settings.btn=!0,b.hide(),c.hide(),d.removeClass("cardout").show(),d.find(".card-question li span").css({display:"none"}),d.find(".card-question li cite").css({display:"none"}),a.main.find(".next span").show(),a.main.find(".next em").hide(),a.score.find(".score-card-content>span").removeClass("papa"),e.hide(),e.eq(a.settings.now).show(),a.main.show()},share:function(){function a(a){var a=a||window.event;a.preventDefault(),a.cancelBubble=!0}var b=$(document).height(),c=($(window).height(),$(window).scrollTop()),d=$("body");if(0!=$("div[name=alertmask]").length)return!1;!function(){var a="<div class='alertmask' name='alertmask' style='background:#000; opacity:0.75;display:block;overflow:hidden;position:fixed; left:0px; top:0px; width:100%; z-index:999; height:"+(b+c)+"px' ></div>",e="<div class='share' id='share'><div class='share-content'><span></span></div></div>";d.append(a),d.append(e)}(),d.eq(0).css("overflow","hidden"),document.addEventListener("touchmove",a,!1);var e=$(".alertmask"),f=$("#share");$("#share span")[0].addEventListener("touchstart",function(){document.removeEventListener("touchmove",a,!1),e.remove(),f.remove(),d.eq(0).css("overflow","auto")},!1)}};